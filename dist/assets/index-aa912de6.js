import{M as b,d as Z,r as f,G as ee,c as ae,N as te,U as le,y as oe,S as A,J as re,e as n,O as ne,o as v,f as P,g as t,w as l,A as T,v as N,j as V,h as i,m as w,t as j,P as z,R as u,_ as se}from"./index-9436cd64.js";const ie=(d,s)=>b.get(`/admin/product/baseTrademark/${d}/${s}`),de=d=>d.id?b.put("/admin/product/baseTrademark/update",d):b.post("/admin/product/baseTrademark/save",d),ce=d=>b.delete(`/admin/product/baseTrademark/remove/${d}`),ue={style:{height:"100px",display:"flex","align-items":"center","justify-content":"center"}},me=["src"],pe=["src"],_e=Z({__name:"index",setup(d){let s=f(parseInt(ee("trademarkPageNo"))),k=f([]),h=f(0),c=f(!1),r=ae({tmName:"",logoUrl:""}),m=f(),p=te();const _=async(e=1)=>{s.value=e;let o=await ie(s.value,p.limit);o.code==200&&(k.value=o.data.records,h.value=o.data.total)},q=()=>{A("Limit",p.limit),_()},x=le(()=>r.id?"修改品牌":"添加品牌"),B=()=>{var e;c.value=!0,r.tmName="",r.logoUrl="",delete r.id,(e=m.value)==null||e.clearValidate()},D=e=>{var o;(o=m.value)==null||o.clearValidate(),c.value=!0,Object.assign(r,e)},U=()=>{c.value=!1},G=e=>e.type!=="image/jpeg"&&e.type!=="image/png"&&e.type!=="image/jif"?(u.error("品牌标识必须是JPG/PNG/GIF格式"),!1):e.size/1024/1024>2?(u.error("品牌标识大小不能超过2MB"),!1):!0,M=e=>{r.logoUrl=e.data,m.value.clearValidate("logoUrl")},O=async()=>{try{await m.value.validate(),(await de(r)).code==200?(U(),u.success(x.value+"成功"),_(r.id?s.value:Math.floor(h.value/p.limit)+1)):(U(),u.error(x.value+"失败"))}catch{}};oe(s,e=>{A("trademarkPageNo",e)}),re(()=>{_()});const H={tmName:[{min:2,max:15,message:"品牌名称至少两个字符",trigger:"blur"},{required:!0,message:"请输入品牌名称",trigger:"blur"}],logoUrl:[{required:!0,message:"请上传品牌标识",trigger:"blur"}]},R=async e=>{(await ce(e.id)).code==200?(u.success("删除成功"),_(k.value.length>1?s.value:s.value-1)):u.error("删除失败")};return(e,o)=>{const g=n("el-button"),y=n("el-table-column"),E=n("el-popconfirm"),I=n("el-table"),$=n("el-pagination"),J=n("el-card"),L=n("el-input"),S=n("el-form-item"),K=n("Plus"),Q=n("el-icon"),W=n("el-upload"),F=n("el-form"),X=n("el-dialog"),C=ne("has");return v(),P("div",null,[t(J,{class:"box-card",shadow:"hover"},{default:l(()=>[T((v(),N(g,{type:"primary",icon:"Plus",onClick:B},{default:l(()=>[V(" 添加品牌 ")]),_:1})),[[C,"btn.Trademark.add"]]),t(I,{style:{margin:"20px 0"},border:"",data:i(k)},{default:l(()=>[t(y,{label:"序号",width:"80px",align:"center"},{default:l(({row:a})=>[w("div",null,j(a.id),1)]),_:1}),t(y,{label:"品牌名称",align:"center"},{default:l(({row:a})=>[w("div",ue,j(a.tmName),1)]),_:1}),t(y,{label:"品牌LOGO",align:"center"},{default:l(({row:a})=>[w("img",{src:a.logoUrl,style:{width:"100px"},onerror:"this.src='http://39.98.123.211/group1/M00/03/D9/rBHu8mHmKC6AQ-j2AAAb72A3EO0942.jpg'"},null,8,me)]),_:1}),t(y,{label:"品牌操作",align:"center"},{default:l(({row:a})=>[T(t(g,{type:"warning",icon:"edit",onClick:Y=>D(a)},null,8,["onClick"]),[[C,"btn.Trademark.update"]]),T((v(),N(E,{title:"确定要删除当前的品牌吗? ",width:"230px",icon:"Warning",onConfirm:Y=>R(a)},{reference:l(()=>[t(g,{type:"danger",icon:"delete"})]),_:2},1032,["onConfirm"])),[[C,"btn.Trademark.remove"]])]),_:1})]),_:1},8,["data"]),t($,{"current-page":i(s),"onUpdate:currentPage":o[0]||(o[0]=a=>z(s)?s.value=a:s=a),"page-size":i(p).limit,"onUpdate:pageSize":o[1]||(o[1]=a=>i(p).limit=a),"page-sizes":[3,5,7,9],background:!0,layout:"prev, pager, next, jumper, ->, sizes, total",total:i(h),onCurrentChange:_,onSizeChange:q},null,8,["current-page","page-size","total"])]),_:1}),t(X,{modelValue:i(c),"onUpdate:modelValue":o[3]||(o[3]=a=>z(c)?c.value=a:c=a),title:i(x),style:{width:"450px","border-radius":"10px"}},{footer:l(()=>[t(g,{onClick:U},{default:l(()=>[V("取消")]),_:1}),t(g,{type:"primary",onClick:O},{default:l(()=>[V("确定")]),_:1})]),default:l(()=>[t(F,{style:{"margin-left":"50px"},model:i(r),rules:H,ref_key:"formRef",ref:m},{default:l(()=>[t(S,{label:"品牌名称",style:{width:"216px"},prop:"tmName"},{default:l(()=>[t(L,{placeholder:"请输入品牌的名称",modelValue:i(r).tmName,"onUpdate:modelValue":o[2]||(o[2]=a=>i(r).tmName=a)},null,8,["modelValue"])]),_:1}),t(S,{label:"品牌标识",prop:"logoUrl"},{default:l(()=>[t(W,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":M,"before-upload":G},{default:l(()=>[i(r).logoUrl?(v(),P("img",{key:0,src:i(r).logoUrl,class:"avatar"},null,8,pe)):(v(),N(Q,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[t(K)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});const fe=se(_e,[["__scopeId","data-v-c03f9989"]]);export{fe as default};
