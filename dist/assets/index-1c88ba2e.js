import{M as v,d as R,r as y,c as T,J as $,e as r,O as B,o as _,f as H,g as l,w as s,A as V,v as C,j as c,t as J,h as d,m as S,P as h,z as q,R as f}from"./index-9436cd64.js";const F=()=>v.get("/admin/acl/permission"),G=m=>m.id?v.put("/admin/acl/permission/update",m):v.post("/admin/acl/permission/save",m),I=m=>v.delete("/admin/acl/permission/remove/"+m),K={class:"dialog-footer"},X=R({__name:"index",setup(m){let k=y([]),n=y(!1),t=T({code:"",level:0,name:"",pid:0}),p=y();$(()=>{b()});const b=async()=>{let a=await F();a.code==200&&(k.value=a.data)},M=a=>{Object.assign(t,{id:0,code:"",level:0,name:"",pid:0}),n.value=!0,q(()=>{p.value.clearValidate()}),t.level=a.level+1,t.pid=a.id},N=a=>{n.value=!0,Object.assign(t,a),q(()=>{p.value.clearValidate()})},z=async()=>{await p.value.validate(),(await G(t)).code==200?(f.success(t.id?"更新成功":"添加成功"),n.value=!1,b()):f.error(t.id?"更新失败":"添加失败")},A=async a=>{(await I(a)).code==200?(f.success("删除成功"),b()):f.error("删除失败")},D={name:[{required:!0,trigger:"blur",validator:(a,o,i)=>{o.trim().length>=2?i():i(new Error("菜单名称至少两位"))}}],code:[{required:!0,trigger:"blur",validator:(a,o,i)=>{o.trim().length>=2?i():i(new Error("权限数值至少两位"))}}]};return(a,o)=>{const i=r("el-table-column"),u=r("el-button"),E=r("el-popconfirm"),O=r("el-table"),w=r("el-input"),x=r("el-form-item"),U=r("el-form"),j=r("el-dialog"),g=B("has");return _(),H("div",null,[l(O,{data:d(k),style:{width:"100%","margin-bottom":"20px"},"row-key":"id",border:""},{default:s(()=>[l(i,{label:"名称",prop:"name"}),l(i,{label:"权限值",prop:"code"}),l(i,{label:"修改时间",prop:"updateTime"}),l(i,{label:"操作"},{default:s(({row:e})=>[V((_(),C(u,{onClick:P=>M(e),type:e.level==3?"warning":"success",size:"small",disabled:e.level==4},{default:s(()=>[c(J(e.level==3?"添加功能":"添加菜单"),1)]),_:2},1032,["onClick","type","disabled"])),[[g,"btn.Permission.add"]]),V((_(),C(u,{onClick:P=>N(e),type:"primary",size:"small",disabled:e.level==1},{default:s(()=>[c(" 编辑 ")]),_:2},1032,["onClick","disabled"])),[[g,"btn.Permission.update"]]),V((_(),C(E,{title:"确定要删除当前的菜单吗? ",width:"240px",icon:"warning",onConfirm:P=>A(e.id)},{reference:s(()=>[l(u,{type:"danger",size:"small",disabled:e.level==1},{default:s(()=>[c(" 删除 ")]),_:2},1032,["disabled"])]),_:2},1032,["onConfirm"])),[[g,"btn.Permission.remove"]])]),_:1})]),_:1},8,["data"]),l(j,{modelValue:d(n),"onUpdate:modelValue":o[3]||(o[3]=e=>h(n)?n.value=e:n=e),title:d(t).id?"更新菜单":"添加菜单",width:"30%",style:{"border-radius":"10px"}},{footer:s(()=>[S("span",K,[l(u,{onClick:o[2]||(o[2]=e=>h(n)?n.value=!1:n=!1)},{default:s(()=>[c("取消")]),_:1}),l(u,{type:"primary",onClick:z},{default:s(()=>[c("确定")]),_:1})])]),default:s(()=>[l(U,{model:d(t),rules:D,ref_key:"form",ref:p},{default:s(()=>[l(x,{label:"名称",prop:"name"},{default:s(()=>[l(w,{placeholder:"请输入菜单名称",modelValue:d(t).name,"onUpdate:modelValue":o[0]||(o[0]=e=>d(t).name=e),style:{width:"75%"}},null,8,["modelValue"])]),_:1}),l(x,{label:"权限",prop:"code"},{default:s(()=>[l(w,{placeholder:"请输入权限数值",modelValue:d(t).code,"onUpdate:modelValue":o[1]||(o[1]=e=>d(t).code=e),style:{width:"75%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{X as default};
